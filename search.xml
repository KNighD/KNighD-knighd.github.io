<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡æ­å»º react é¡¹ç›®é‡åˆ°çš„å‘</title>
      <link href="/2020/07/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%90%AD%E5%BB%BA%20react%20%E9%A1%B9%E7%9B%AE%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/"/>
      <url>/2020/07/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%90%AD%E5%BB%BA%20react%20%E9%A1%B9%E7%9B%AE%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h5 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h5><p>ç”µå•†é¡¹ç›®éœ€è¦æ­å»ºä¸€ä¸ª h5 é¡¹ç›®ã€‚è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹æ­å»ºè¿‡ç¨‹é‡åˆ°çš„å‘ï¼Œä½œä¸ºæ€»ç»“ã€‚</p><a id="more"></a><p>ui æ¡†æ¶ï¼šä¸ºäº†ç»Ÿä¸€ ui æ¡†æ¶ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨ antd-mobileã€‚</p><p>æ‰“åŒ…ï¼šparceljs åœ¨æ­¤å‰çš„é¡¹ç›®ä¸­å·²ç»ä½¿ç”¨è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œæ‰“åŒ…é€Ÿåº¦è¾ƒ cra å¿«ï¼Œä¸”é…ç½®ç®€å•ï¼Œå› æ­¤æ‹Ÿç”¨ parcelã€‚</p><p>tsï¼šå¤šäººé¡¹ç›®è¿˜æ˜¯ä¸Š tsï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p><p>å¾ˆå¿«å°±æ­å»ºå¥½demoï¼Œæ¥ç€å°±å¼€å§‹é‡åˆ°ä¸€äº›é—®é¢˜ã€‚</p><h5 id="antd-mobile-æŒ‰éœ€åŠ è½½"><a href="#antd-mobile-æŒ‰éœ€åŠ è½½" class="headerlink" title="antd-mobile æŒ‰éœ€åŠ è½½"></a>antd-mobile æŒ‰éœ€åŠ è½½</h5><p>antd-mobile æŒ‰éœ€åŠ è½½æ¨èä½¿ç”¨ <a href="https://github.com/ant-design/babel-plugin-import" target="_blank" rel="noopener">babel-plugin-import</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .babelrc or babel-loader option</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [</span><br><span class="line">    ["import", &#123; libraryName: "antd-mobile", style: "css" &#125;] // `style: true` ä¼šåŠ è½½ less æ–‡ä»¶</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å‰ parcel å®é™…ä¸Šå†…ç½®æ”¯æŒäº† tsï¼Œç›´æ¥è½¬æˆ es5 äº†ï¼Œå› æ­¤æ­¤å‰æ²¡æœ‰é¢å¤–å†é…ç½® babelã€‚</p><p>ğŸ¤”  babel-plugin-import åªæ”¯æŒes6 moduleå†™æ³•çš„ä»£ç ï¼Œçœ‹æ¥éœ€è¦å…ˆæŠŠ ts è½¬æˆ es6 ç„¶ååœ¨é€šè¿‡ babel è½¬æˆ es5ï¼Œ æ²¡é—®é¢˜ï¼Œå®‰æ’ï½ äºæ˜¯</p><ol><li><p>æ–°å¢ .babelrc</p></li><li><p>ä¿®æ”¹  tsconfig çš„ module ä¸º <code>es6</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"ES6"</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>é¡¹ç›®å¯åŠ¨ï¼Œæ²¡é—®é¢˜ã€‚ä½†æ˜¯ vscode å¼€å§‹æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import React from &#39;react&#39;</span><br><span class="line">&#x2F;&#x2F; Module &#39;&quot;&#x2F;node_modules&#x2F;@types&#x2F;react&#x2F;index&quot;&#39; can only be default-imported using the &#39;allowSyntheticDefaultImports&#39; flag</span><br></pre></td></tr></table></figure><p>æ ¹æœ¬åŸå› æ˜¯ç”±äº react å¯¼å‡ºå¦‚ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="built_in">require</span>(<span class="string">'react.development.js'</span>)</span><br></pre></td></tr></table></figure><p>è€Œé</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports.default = <span class="built_in">require</span>(<span class="string">'react.development.js'</span>)</span><br></pre></td></tr></table></figure><p>Babel ä¼šåœ¨ commonjs æ ¼å¼æ·»åŠ  default å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®© ts ä¸è¦æç¤ºè¿™ç§ç±»å‹çš„æŠ¥é”™ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"allowSyntheticDefaultImports"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ¤”ä¸è¿‡ä¸ºä»€ä¹ˆä¸€å¼€å§‹ parcel ä¸ä¼šæŠ¥é”™å‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥è·¯ç”±åŠ¨æ€å¼•å…¥ç»„ä»¶å¼€å§‹æŠ¥é”™ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Suspense, lazy &#125; from &#39;react&#39;</span><br><span class="line"></span><br><span class="line">const List &#x3D; lazy(() &#x3D;&gt; import(&#39;.&#x2F;modules&#x2F;List&#39;))</span><br><span class="line">&#x2F;&#x2F; Dynamic imports are only supported when the &#39;--module&#39; flag is set to &#39;es2020&#39;, &#39;esnext&#39;, &#39;commonjs&#39;, &#39;amd&#39;, &#39;system&#39;, or &#39;umd&#39;.</span><br></pre></td></tr></table></figure><p>çœ‹æ¥ <code>es6</code> æ˜¯ä¸æ”¯æŒ import() è¯­æ³•, é‚£å¥½åŠï¼Œå°† module æ”¹æˆ <code>esnext</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;module&quot;: &quot;ESNext&quot;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¼•å…¥ anti-mobile ç»„ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; List &#125; <span class="keyword">from</span> <span class="string">'antd-mobile'</span></span><br><span class="line"><span class="comment">// Cannot find module 'antd-mobile' or its corresponding type declarations.</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æç¤ºæ‰¾ä¸åˆ°å¯¹åº”çš„æ¨¡å—å£°æ˜ï¼Œ æ­¤æ—¶æˆ‘çš„å†…å¿ƒæ˜¯å´©æºƒçš„ï¼Œçœ‹èµ·æ¥åº”è¯¥æ˜¯æ¨¡å—è§£æè·¯å¾„ä¸å¯¹ï¼Œå› æ­¤åœ¨ tsconfig ä¸­æ˜¾å¼é…ç½® <code>moduleResolution</code>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"moduleResolution"</span>: <span class="string">"Node"</span>,</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸å†æŠ¥é”™äº†ï¼Œçœ‹çœ‹ ts æ–‡æ¡£çš„è§£é‡Šå§ï¼Œts å…±æœ‰ä¸¤ç§å¯ç”¨çš„æ¨¡å—è§£æç­–ç•¥ï¼š<a href="https://www.tslang.cn/docs/handbook/module-resolution.html#node" target="_blank" rel="noopener">Node</a>å’Œ<a href="https://www.tslang.cn/docs/handbook/module-resolution.html#classic" target="_blank" rel="noopener">Classic</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span> === <span class="string">"AMD"</span> or <span class="string">"System"</span> or <span class="string">"ES6"</span> ? <span class="string">"Classic"</span> : <span class="string">"Node"</span></span><br></pre></td></tr></table></figure><p>ğŸ¤” æŒ‰ç†è¯´ module ä¸º esnext çš„è¯å²‚ä¸æ˜¯åº”è¯¥æŒ‰ node ç­–ç•¥è§£æï¼Ÿä½†æ˜¯ç›®å‰çœ‹æ¥ä¼¼ä¹ä¸æ˜¯è¿™æ ·çš„ï¼Ÿ</p><h5 id="é…ç½®-antd-mobile-ä¸»é¢˜"><a href="#é…ç½®-antd-mobile-ä¸»é¢˜" class="headerlink" title="é…ç½® antd-mobile ä¸»é¢˜"></a>é…ç½® antd-mobile ä¸»é¢˜</h5><p>æ¥ä¸‹æ¥éœ€è¦é…ç½®ä¸»é¢˜ï¼Œanti-mobile æ¨èä½¿ç”¨ <a href="http://lesscss.org/usage/#using-less-in-the-browser-modify-variables" target="_blank" rel="noopener">modifyVars</a> æ¥é…ç½®ä¸»é¢˜ã€‚</p><p>å°† .babelrc æ”¹æˆåšä¸€ä¸‹è°ƒæ•´ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">"plugins"</span>: [</span><br><span class="line">        [<span class="string">"import"</span>, &#123;<span class="string">"libraryName"</span>: <span class="string">"antd-mobile"</span>, <span class="string">"style"</span>: <span class="literal">true</span>&#125;],</span><br><span class="line">        ...</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ webpack çš„ç»éªŒï¼Œæ­¤æ—¶éœ€è¦å¼€å¯ <code>javascriptEnabled: true</code>é—®é¢˜æ¥äº† parcel å†…ç½®æ”¯æŒ less ï¼Œé‚£æˆ‘ä»¬è¦åœ¨å“ªé‡Œå»é…ç½® less å‘¢ï¼Ÿæ ¹æ® <a href="https://github.com/parcel-bundler/parcel/issues/907" target="_blank" rel="noopener">issue</a> æåˆ°å¯ä»¥ç”¨ .lessrc æ–‡ä»¶æ¥é…ç½®ï¼Œä½†æ˜¯æˆ‘ç»è¿‡å°è¯•å‘ç°å…¶å®æ˜¯æ— æ•ˆçš„ã€‚ã€‚</p><p>è‡³æ­¤åŸºæœ¬æ”¾å¼ƒ parcelã€‚parcel åœ¨å¿«é€Ÿæ­å»ºå®éªŒæ€§é¡¹ç›®æ—¶ç¡®å®æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä¸è¿‡ç”Ÿæ€ç¡®å®ä¸å¦‚ webpackï¼Œç”±æ­¤è½¬å‘ä½¿ç”¨ create-react-app</p><h5 id="create-react-app"><a href="#create-react-app" class="headerlink" title="create-react-app"></a>create-react-app</h5><p>ä½¿ç”¨ cra å¾ˆå¿«ä¹Ÿå»ºå¥½ demo,</p><p>æ¥ä¸‹æ¥è§£å†³å¦‚ä½•è®© cra åˆ›å»ºçš„é¡¹ç›®æ”¯æŒ less ï¼Œè¿™ä¸ªç®€å•ï¼š</p><p>é€šè¿‡ <code>customize-cra</code> æä¾›çš„ <code>addLessLoader</code> æ–¹æ³•å³å¯ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº† <code>fixBabelImports</code>  å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ·»åŠ  babel-plugin-import é…ç½®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  override,</span><br><span class="line">  fixBabelImports,</span><br><span class="line">  addLessLoader,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">'customize-cra'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = override(</span><br><span class="line">  fixBabelImports(<span class="string">'import'</span>, &#123;</span><br><span class="line">    libraryName: <span class="string">'antd-mobile'</span>,</span><br><span class="line">    style: <span class="literal">true</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  addLessLoader(&#123;</span><br><span class="line">    lessOptions: &#123;</span><br><span class="line">      javascriptEnabled: <span class="literal">true</span>,</span><br><span class="line">      modifyVars: &#123;</span><br><span class="line">        <span class="string">'@brand-primary'</span>: <span class="string">'#ff74b9'</span>,</span><br><span class="line">        <span class="string">'brand-primary-tap'</span>: <span class="string">'#ff9cca'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ¥ç€æ˜¯é…ç½®è·¯å¾„åˆ«åé‡åˆ°çš„é—®é¢˜ï¼Œé€šè¿‡ <code>customize-cra</code>  æä¾›çš„ <code>addWebpackAlias</code> å¯ä»¥é…ç½®åˆ«åï¼Œä½†æ˜¯ typescript ä¸€ç›´æ— æ³•è§£æå¯¹åº”åˆ«åï¼Œé‚£ä¹ˆåº”è¯¥åªéœ€è¦é…ç½®å¥½ ts çš„ paths å°±è¡Œäº†å§ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"baseUrl"</span>: <span class="string">"."</span>,</span><br><span class="line">    <span class="attr">"paths"</span>: &#123;</span><br><span class="line">      <span class="attr">"@/*"</span>: [<span class="string">"./src/*"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vscode ä¸å†æŠ¥é”™äº†,æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»äº†<code>npm run start</code>ï¼š</p><p>æ§åˆ¶å°æ˜¾ç¤º <code>- compilerOptions.paths must not be set (aliased imports are not supported)</code> å¹¶ä¸”è‡ªåŠ¨æŠŠ tscongfig ä¸­çš„ paths ç§»é™¤äº†ğŸ˜‚</p><p>æ ¹æ® <a href="https://github.com/timarney/react-app-rewired/issues/375" target="_blank" rel="noopener">issue</a>ï¼Œä½¿ç”¨ extends çš„æ–¹å¼å°† paths ç§»åŠ¨åˆ°å•ç‹¬çš„æ–‡ä»¶å npm run startï¼Œæœç„¶ä¸ä¼šè¢«é‡å†™äº†ï¼</p><p>å°±åœ¨æˆ‘ä»¥ä¸ºæ²¡é—®é¢˜çš„æ—¶å€™ï¼Œè¿è¡Œäº†ä¸‹ buildï¼Œemmmï¼Œbuild ä¾ç„¶ä¼šå‡ºç°ä»¥ä¸Šé”™è¯¯ï¼Œå¹¶ä¸”è™½ç„¶ build æˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰ index.html æ–‡ä»¶è¾“å‡ºã€‚</p><p>åŒæ ·åœ¨ build æ—¶ï¼Œmini-css-extract-plugin æç¤º Conflicting orderï¼Œ é”™è¯¯ä½ç½®åœ¨ antd-mobile çš„æ ·å¼æ–‡ä»¶ï¼Œè€ƒè™‘å°† <code>customize-cra</code> æ›¿æ¢æˆ <a href="https://github.com/gsoft-inc/craco" target="_blank" rel="noopener">craco</a> </p><p>æœªå®Œå¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡å­¦ Generator</title>
      <link href="/2020/07/15/%E9%87%8D%E5%AD%A6%20Generator/"/>
      <url>/2020/07/15/%E9%87%8D%E5%AD%A6%20Generator/</url>
      
        <content type="html"><![CDATA[<h5 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h5><p>åœ¨å®é™…å·¥ä½œçš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œä½¿ç”¨åˆ° Generator æ¯”è¾ƒå°‘ã€‚è¿‘æœŸæœ‰ä¸ªé¡¹ç›®çŠ¶æ€ç®¡ç†ä½¿ç”¨çš„æ˜¯ redux-sagaï¼Œè€Œ redux-saga åˆæ˜¯åŸºäº Generatorï¼Œå€Ÿæ­¤æœºä¼šé‡æ–°å­¦äº†ä¸‹ Generatorã€‚</p><p>æœ¬æ–‡ä¸»è¦æ˜¯è®°å½• generator çš„è¦ç‚¹ï¼Œä»¥é˜²å°†æ¥é—å¿˜ã€‚</p><a id="more"></a><h5 id="è°ƒç”¨-generator-å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨"><a href="#è°ƒç”¨-generator-å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨" class="headerlink" title="è°ƒç”¨ generator å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨"></a>è°ƒç”¨ generator å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</h5><p>æ‰€è°“ generator å®é™…ä¸Šå°±æ˜¯å¸¦æœ‰ * çš„å‡½æ•°ï¼Œè°ƒç”¨åä¸ä¼šæ‰§è¡Œ generator å†…éƒ¨ä»£ç ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª iterator</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'generator'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction()</span><br><span class="line"><span class="built_in">console</span>.log(iterator[<span class="built_in">Symbol</span>.iterator])</span><br><span class="line"></span><br><span class="line"><span class="comment">// function [Symbol.iterator]()</span></span><br></pre></td></tr></table></figure><h5 id="æ‰§è¡Œ-generator"><a href="#æ‰§è¡Œ-generator" class="headerlink" title="æ‰§è¡Œ generator"></a>æ‰§è¡Œ generator</h5><p>æ¯æ¬¡è°ƒç”¨è¿”å›çš„è¿­ä»£å™¨çš„ next æ–¹æ³•å¯ä»¥æ‰§è¡Œ generator ä¸­çš„ä»£ç ï¼Œç›´åˆ°æ‰§è¡Œå®Œé‡åˆ°çš„ç¬¬ä¸€ä¸ª yield æˆ–è€… return åå¹¶äº¤å‡ºæ‰§è¡Œæƒ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'1'</span>)</span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'2'</span>)</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction()</span><br><span class="line">iterator.next()</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">iterator.next()</span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h5 id="return-ä¸-yield-çš„å¼‚åŒ"><a href="#return-ä¸-yield-çš„å¼‚åŒ" class="headerlink" title="return ä¸ yield çš„å¼‚åŒ"></a>return ä¸ yield çš„å¼‚åŒ</h5><p>æ‰§è¡Œ iterator.next è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…æ‹¬ value å’Œ done ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ value å°±æ˜¯ <code>yield</code> æˆ– <code>return</code> åé¢è¡¨è¾¾å¼çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction()</span><br><span class="line"><span class="keyword">var</span> a = iterator.next()</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line"><span class="comment">// &#123; value: 1, done: false &#125;</span></span><br><span class="line"><span class="keyword">var</span> b = iterator.next()</span><br><span class="line"><span class="built_in">console</span>.log(b)</span><br><span class="line"><span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>yield ä¸ return ç±»ä¼¼ï¼Œä½† yield æ˜¯æš‚åœçš„æ„æ€ï¼Œè€Œ return åˆ™ä»£è¡¨ç»“æŸ, return ä¹‹åçš„ä»£ç å°†ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚</p><p>done ä¸º true è¡¨ç¤ºéå†ç»“æŸï¼Œä½†æ˜¯æ­¤æ—¶ä¾ç„¶å¯ä»¥å¯ä»¥ç»§ç»­è°ƒç”¨ iterator.next()ï¼Œåªä¸è¿‡è¿”å›å€¼å°†æ˜¯ { value: undefined, done: true }ã€‚</p><p><code>for...of</code>å¾ªç¯å¯ä»¥è‡ªåŠ¨éå† Generator å‡½æ•°è¿è¡Œæ—¶ç”Ÿæˆçš„<code>Iterator</code>å¯¹è±¡ï¼Œç›´åˆ° done å˜ä¸º trueã€‚</p><p>âš ï¸ done ä¸º true çš„è¿è¡Œç»“æœä¼šè¢«æŠ›å¼ƒæ‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> iterator) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h5 id="next-çš„å‚æ•°"><a href="#next-çš„å‚æ•°" class="headerlink" title="next çš„å‚æ•°"></a>next çš„å‚æ•°</h5><p>next çš„å‚æ•°å¯ä»¥æœ€ä¸º yield è¯­å¥çš„è¿”å›å€¼:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="keyword">yield</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>, a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction()</span><br><span class="line">iterator.next()</span><br><span class="line">iterator.next(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// a 1</span></span><br></pre></td></tr></table></figure><h5 id="yield"><a href="#yield" class="headerlink" title="yield *"></a>yield *</h5><p>é€šè¿‡ yield * å¯ä»¥è¿›å…¥åˆ°å¦ä¸€ä¸ª generator ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'foo'</span>;</span><br><span class="line">    <span class="keyword">yield</span> * bar();</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> bar = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'bar'</span>;</span><br><span class="line">    <span class="keyword">yield</span> * baz();</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> baz = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'baz'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> foo()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// foo</span></span><br><span class="line"><span class="comment">// bar</span></span><br><span class="line"><span class="comment">// baz</span></span><br></pre></td></tr></table></figure><h5 id="å‘-generaotr-å†…éƒ¨æŠ›å¼‚å¸¸"><a href="#å‘-generaotr-å†…éƒ¨æŠ›å¼‚å¸¸" class="headerlink" title="å‘ generaotr å†…éƒ¨æŠ›å¼‚å¸¸"></a>å‘ generaotr å†…éƒ¨æŠ›å¼‚å¸¸</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> generatorFunction = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">yield</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="string">'a'</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> e;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'Generator caught'</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> iterator = generatorFunction();</span><br><span class="line">iterator.next();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    iterator.throw(<span class="string">'a'</span>);</span><br><span class="line">    iterator.throw(<span class="string">'b'</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Uncaught'</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Generator caught a</span></span><br><span class="line"><span class="comment">// Uncaught b</span></span><br></pre></td></tr></table></figure><p>èµ„æ–™ä¸»è¦å‚è€ƒè‡ª  <a href="https://github.com/gajus/gajus.com-blog/blob/master/posts/the-definitive-guide-to-the-javascript-generators/index.md" target="_blank" rel="noopener">generator æƒå¨æŒ‡å—</a></p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test_my_site</title>
      <link href="/2020/07/08/test-my-site/"/>
      <url>/2020/07/08/test-my-site/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
