<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ã€è¯‘ã€‘ReactHooks-å¹¶éé»‘é­”æ³•ï¼Œæœ¬è´¨æ˜¯æ•°ç»„</title>
      <link href="/2020/07/26/%E3%80%90%E8%AF%91%E3%80%91ReactHooks-%E5%B9%B6%E9%9D%9E%E9%BB%91%E9%AD%94%E6%B3%95%EF%BC%8C%E6%9C%AC%E8%B4%A8%E6%98%AF%E6%95%B0%E7%BB%84/"/>
      <url>/2020/07/26/%E3%80%90%E8%AF%91%E3%80%91ReactHooks-%E5%B9%B6%E9%9D%9E%E9%BB%91%E9%AD%94%E6%B3%95%EF%BC%8C%E6%9C%AC%E8%B4%A8%E6%98%AF%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>æœ¬æ–‡ç¿»è¯‘è‡ª <a href="https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e" target="_blank" rel="noopener">React hooks: not magic, just arrays</a>ï¼Œè¯¥æ–‡ç« å¾ˆå¥½çš„é˜é‡Šäº† react hooks åŸç†ï¼Œæˆ‘å°†ä¿æŒåŸæ–‡çš„æ„æ€è¿›è¡Œç¿»è¯‘ï¼Œå¦‚æœ‰è‡ªå·±æ„Ÿè§‰ä¸æ¸…æ¥šçš„åœ°æ–¹å°†ä¼šåœ¨æ‹¬å·ä¸­æ³¨æ˜ã€‚ä»¥ä¸‹ä¸ºç¿»è¯‘å†…å®¹ã€‚</p><p>æˆ‘æ˜¯ hooks api çš„å¿ å®ç²‰ä¸ã€‚ç„¶è€Œ hooks åœ¨ä½¿ç”¨æ—¶å´æœ‰ä¸€äº›<a href="https://reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener">å¥‡æ€ªçš„çº¦æŸ</a>ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ç»™å°è¯•å»ç†è§£è¿™äº›è§„åˆ™ç”±æ¥çš„äººæä¾›ä¸€ä¸ªäº†æ¨¡å‹ï¼Œç”¨äºæ€è€ƒå¦‚ä½•å»ä½¿ç”¨è¿™äº›æ–° apiã€‚</p><a id="more"></a><h4 id="hooks-çš„è§„åˆ™"><a href="#hooks-çš„è§„åˆ™" class="headerlink" title="hooks çš„è§„åˆ™"></a>hooks çš„è§„åˆ™</h4><p>åœ¨ <a href="https://reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener">hooks proposal documentation</a>  çš„æçº²ä¸­ï¼ŒReact æ ¸å¿ƒå›¢é˜Ÿè§„å®šäº†ä¸¤æ¡å¼€å‘è€…åœ¨ä½¿ç”¨ hooks æ—¶éœ€è¦éµå®ˆçš„ä¸»è¦è§„åˆ™ï¼š</p><ul><li>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–è€…æ˜¯åµŒå¥—å‡½æ•°ä¸­ä½¿ç”¨ hooks</li><li>åªèƒ½åœ¨ React Functions ä¸­æ‰èƒ½ä½¿ç”¨ hooks</li></ul><p>åè€…æˆ‘è®¤ä¸ºæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚è¦å°†è¡Œä¸ºé™„åŠ åˆ°å‡½æ•°å¼ç»„ä»¶ä¸Šï¼Œä½ éœ€è¦èƒ½å¤Ÿä»¥æŸç§æ–¹å¼å°†è¯¥è¡Œä¸ºä¸ç»„ä»¶å…³è”èµ·æ¥ã€‚ï¼ˆåŸæ–‡ä¸ºï¼š To attach behaviour to a functional component you need to be able to associate that behaviour with the component somehow. ä¸å¤ªç†è§£ä½œè€…æƒ³è¡¨è¾¾çš„æ„æ€ï¼‰</p><p>å‰è€…æˆ‘è®¤ä¸ºä¼šæ¯”è¾ƒè®©äººå›°æƒ‘ï¼Œå› ä¸ºåƒè¿™æ ·ä½¿ç”¨ api å¯èƒ½çœ‹èµ·æ¥ä¸å¤ªè‡ªç„¶ã€‚è€Œè¿™æ­£æ˜¯æˆ‘ä»Šå¤©æƒ³è¦æ¢è®¨çš„å†…å®¹ã€‚</p><h4 id="hooks-çš„çŠ¶æ€ç®¡ç†éƒ½æ˜¯åŸºäºæ•°ç»„"><a href="#hooks-çš„çŠ¶æ€ç®¡ç†éƒ½æ˜¯åŸºäºæ•°ç»„" class="headerlink" title="hooks çš„çŠ¶æ€ç®¡ç†éƒ½æ˜¯åŸºäºæ•°ç»„"></a>hooks çš„çŠ¶æ€ç®¡ç†éƒ½æ˜¯åŸºäºæ•°ç»„</h4><p>ä¸ºäº†æ›´æ¸…æ™°åœ°ç†è§£å¿ƒæ™ºæ¨¡å‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å®ç°ä¸€ä¸ªç®€å•çš„ hooks apiã€‚</p><p><strong>æ³¨æ„è¿™åªæ˜¯ API çš„ä¸€ç§å¯èƒ½çš„å®ç°æ–¹å¼åŠçŒœæƒ³ï¼Œç”¨äºè®©ä½ ç†è§£ï¼Œè€Œé API çœŸæ­£çš„å†…éƒ¨å®ç°æ–¹å¼</strong></p><h4 id="æˆ‘ä»¬å¦‚ä½•å®ç°-useState"><a href="#æˆ‘ä»¬å¦‚ä½•å®ç°-useState" class="headerlink" title="æˆ‘ä»¬å¦‚ä½•å®ç° useState?"></a>æˆ‘ä»¬å¦‚ä½•å®ç° <code>useState</code>?</h4><p>è®©æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªå®ä¾‹æ¥æ¼”ç¤ºå¦‚ä½•å®ç°ä¸€ä¸ª state hookã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»„ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs react">function RenderFunctionComponent() &#123;<br>  const [firstName, setFirstName] &#x3D; useState(&quot;Rudi&quot;);<br>  const [lastName, setLastName] &#x3D; useState(&quot;Yardley&quot;);<br><br>  return (<br>    &lt;Button onClick&#x3D;&#123;() &#x3D;&gt; setFirstName(&quot;Fred&quot;)&#125;&gt;Fred&lt;&#x2F;Button&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª Hooks api èƒŒåçš„æ€æƒ³æ˜¯ï¼Œä½ å¯ä»¥ç”¨ hook å‡½æ•°è¿”å›çš„æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ä½œä¸º setter æ–¹æ³•ï¼Œè¿™ä¸ª setter æ–¹æ³•å¯ä»¥æ§åˆ¶è¢« hook ç®¡ç†çš„çŠ¶æ€ã€‚</p><h4 id="é‚£ä¹ˆ-React-æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸ªçš„å‘¢ï¼Ÿ"><a href="#é‚£ä¹ˆ-React-æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸ªçš„å‘¢ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆ React æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸ªçš„å‘¢ï¼Ÿ"></a>é‚£ä¹ˆ React æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸ªçš„å‘¢ï¼Ÿ</h4><p>è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªåœ¨ React å†…éƒ¨æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚ä»¥ä¸‹å†…å®¹å°†åœ¨ç‰¹å®šç»„ä»¶çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚è¿™å°±æ˜¯è¯´æ•°æ®å­˜å‚¨åœ¨è¦æ¸²æŸ“çš„ç»„ä»¶çš„ä¸Šä¸€å±‚ã€‚è¿™ä¸ª state ä¸ä¸å…¶ä»–ç»„ä»¶å…±äº«ï¼Œä½†æ˜¯ç»´æŠ¤åœ¨ä¸€ä¸ªå¯ä»¥ç”¨äºè¯¥ç»„ä»¶åç»­æ¸²æŸ“çš„ä½œç”¨åŸŸå†…ã€‚ï¼ˆåŸæ–‡ï¼šThe following would work within the execution context for rendering a particular component. That means that the data stored here lives one level outside of the component being rendered. This state is not shared with other components but it is maintained in a scope that is accessible to subsequent rendering of the specific componentï¼‰</p><ol><li><p>åˆå§‹åŒ–</p><p>åˆ›å»ºä¸¤ä¸ªç©ºæ•°ç»„ï¼š<code>setter</code> å’Œ <code>state</code></p><p>å°†æŒ‡é’ˆè®¾ç½®ä¸º 0</p><p><img src="https://miro.medium.com/max/1280/1*LAZDuAEm7nbcx0vWVKJJ2w.png" alt="Image for post"></p></li></ol><ol start="2"><li><p>é¦–æ¬¡æ¸²æŸ“</p><p>é¦–æ¬¡è¿è¡Œè¯¥ç»„ä»¶ã€‚</p><p>æ¯æ¬¡è°ƒç”¨ <code>useState</code> ï¼Œå¦‚æœæ˜¯é¦–æ¬¡è¿è¡Œï¼Œåˆ™ push ä¸€ä¸ª setter æ–¹æ³•ï¼ˆç»‘å®šåˆ°æŒ‡é’ˆçš„ä½ç½®ï¼‰åˆ° setters æ•°ç»„ä¸­ï¼Œå¹¶ä¸” push ä¸€äº› state åˆ° state æ•°ç»„ä¸­ã€‚</p><p><img src="https://miro.medium.com/max/1260/1*8TpWnrL-Jqh7PymLWKXbWg.png" alt="Image for post"></p></li><li><p>åç»­æ¸²æŸ“</p><p>æ¯æ¬¡åç»­æ¸²æŸ“ï¼ŒæŒ‡é’ˆå°†è¢«é‡ç½®ï¼Œç„¶åä»å„ä¸ªæ•°ç»„ä¸­è¯»å–å¯¹åº”çš„å€¼ã€‚</p><p><img src="https://miro.medium.com/max/1254/1*qtwvPWj-K3PkLQ6SzE2u8w.png" alt="Image for post"></p></li><li><p>äº‹ä»¶å¤„ç†</p><p>æ¯ä¸€ä¸ª setter éƒ½ä¿å­˜ä¸€ä¸ªå¯¹åº”çš„æŒ‡é’ˆä½ç½®çš„å¼•ç”¨ï¼Œå› æ­¤è§¦å‘ä»»æ„ä¸€ä¸ª <code>setter</code> éƒ½å¯ä»¥ä¿®æ”¹ state æ•°ç»„ä¸­å¯¹åº”æŒ‡é’ˆä½ç½®çš„ stateã€‚</p><p><img src="https://miro.medium.com/max/1260/1*3L8YJnn5eV5ev1FuN6rKSQ.png" alt="Image for post"></p></li></ol><h4 id="ç®€å•çš„å®ç°-And-the-naive-implementation"><a href="#ç®€å•çš„å®ç°-And-the-naive-implementation" class="headerlink" title="ç®€å•çš„å®ç°(And the naive implementation)"></a>ç®€å•çš„å®ç°(And the naive implementation)</h4><p>ä¸‹é¢æ˜¯ç®€å•çš„ä»£ç æ¼”ç¤ºï¼š</p><p><strong>æ³¨æ„ï¼šè¿™ä¸ä»£è¡¨ hooks çš„å®é™…å®ç°ï¼Œä½†æ˜¯åº”è¯¥èƒ½ç»™ä½ ä¸€ä¸ªç†è§£ hooks å·¥ä½œåŸç†çš„æ€è·¯ã€‚è¿™å°±æ˜¯æˆ‘ä¸ºä»€ä¹ˆä½¿ç”¨å—çº§å˜é‡çš„åŸå› ï¼ˆåŸæ–‡ï¼š That is why we are using module level vars etcï¼‰</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs react">let state &#x3D; [];<br>let setters &#x3D; [];<br>let firstRun &#x3D; true;<br>let cursor &#x3D; 0;<br><br>function createSetter(cursor) &#123;<br>  return function setterWithCursor(newVal) &#123;<br>    state[cursor] &#x3D; newVal;<br>  &#125;;<br>&#125;<br><br>&#x2F;&#x2F; This is the pseudocode for the useState helper<br>export function useState(initVal) &#123;<br>  if (firstRun) &#123;<br>    state.push(initVal);<br>    setters.push(createSetter(cursor));<br>    firstRun &#x3D; false;<br>  &#125;<br><br>  const setter &#x3D; setters[cursor];<br>  const value &#x3D; state[cursor];<br><br>  cursor++;<br>  return [value, setter];<br>&#125;<br><br>&#x2F;&#x2F; Our component code that uses hooks<br>function RenderFunctionComponent() &#123;<br>  const [firstName, setFirstName] &#x3D; useState(&quot;Rudi&quot;); &#x2F;&#x2F; cursor: 0<br>  const [lastName, setLastName] &#x3D; useState(&quot;Yardley&quot;); &#x2F;&#x2F; cursor: 1<br><br>  return (<br>    &lt;div&gt;<br>      &lt;Button onClick&#x3D;&#123;() &#x3D;&gt; setFirstName(&quot;Richard&quot;)&#125;&gt;Richard&lt;&#x2F;Button&gt;<br>      &lt;Button onClick&#x3D;&#123;() &#x3D;&gt; setFirstName(&quot;Fred&quot;)&#125;&gt;Fred&lt;&#x2F;Button&gt;<br>    &lt;&#x2F;div&gt;<br>  );<br>&#125;<br><br>&#x2F;&#x2F; This is sort of simulating Reacts rendering cycle<br>function MyComponent() &#123;<br>  cursor &#x3D; 0; &#x2F;&#x2F; resetting the cursor<br>  return &lt;RenderFunctionComponent &#x2F;&gt;; &#x2F;&#x2F; render<br>&#125;<br><br>console.log(state); &#x2F;&#x2F; Pre-render: []<br>MyComponent();<br>console.log(state); &#x2F;&#x2F; First-render: [&#39;Rudi&#39;, &#39;Yardley&#39;]<br>MyComponent();<br>console.log(state); &#x2F;&#x2F; Subsequent-render: [&#39;Rudi&#39;, &#39;Yardley&#39;]<br><br>&#x2F;&#x2F; click the &#39;Fred&#39; button<br><br>console.log(state); &#x2F;&#x2F; After-click: [&#39;Fred&#39;, &#39;Yardley&#39;]<br></code></pre></td></tr></table></figure><h4 id="ä¸ºä»€ä¹ˆé¡ºåºå¾ˆé‡è¦ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé¡ºåºå¾ˆé‡è¦ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé¡ºåºå¾ˆé‡è¦ï¼Ÿ"></a>ä¸ºä»€ä¹ˆé¡ºåºå¾ˆé‡è¦ï¼Ÿ</h4><p>ç°åœ¨å¦‚æœåœ¨ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œï¼Œæˆ‘ä»¬åŸºäºå¤–éƒ¨çš„å› ç´ æˆ–è€…ç»„ä»¶çŠ¶æ€æ”¹å˜äº† hooks çš„é¡ºåºï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼Ÿ</p><p>è®©æˆ‘ä»¬è¯•è¯•çœ‹ react ä¸å»ºè®®æˆ‘ä»¬åšçš„äº‹æƒ…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs react">let firstRender &#x3D; true;<br><br>function RenderFunctionComponent() &#123;<br>  let initName;<br>  <br>  if(firstRender)&#123;<br>    [initName] &#x3D; useState(&quot;Rudi&quot;);<br>    firstRender &#x3D; false;<br>  &#125;<br>  const [firstName, setFirstName] &#x3D; useState(initName);<br>  const [lastName, setLastName] &#x3D; useState(&quot;Yardley&quot;);<br><br>  return (<br>    &lt;Button onClick&#x3D;&#123;() &#x3D;&gt; setFirstName(&quot;Fred&quot;)&#125;&gt;Fred&lt;&#x2F;Button&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ä¸€ä¸ªæ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨äº† <code>useState</code>ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é€ æˆäº†ä»€ä¹ˆæ ·çš„ç ´åï¼š</p><h4 id="åç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“"><a href="#åç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“" class="headerlink" title="åç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“"></a>åç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“</h4><p><img src="https://miro.medium.com/max/1270/1*C4IA_Y7v6eoptZTBspRszQ.png" alt="Image for post"></p><p>åœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬çš„å®ä¾‹å˜é‡ <code>firstName</code> å’Œ <code>lastName</code> æŒ‡å‘çš„æ­£ç¡®çš„æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹çœ‹ç¬¬äºŒæ¬¡æ¸²æŸ“å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p><h4 id="åç»„ä»¶çš„ç¬¬äºŒæ¬¡æ¸²æŸ“"><a href="#åç»„ä»¶çš„ç¬¬äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="åç»„ä»¶çš„ç¬¬äºŒæ¬¡æ¸²æŸ“"></a>åç»„ä»¶çš„ç¬¬äºŒæ¬¡æ¸²æŸ“</h4><p><img src="https://miro.medium.com/max/1274/1*aK7jIm6oOeHJqgWnNXt8Ig.png" alt="Image for post"></p><p>ç°åœ¨æˆ‘ä»¬çš„ state å­˜å‚¨å‡ºç°å¼‚å¸¸ï¼Œ <code>firstName</code> å’Œ <code>lastName</code> éƒ½æŒ‡å‘ â€œRudiâ€ã€‚ä¸Šè¿°æ˜æ˜¾é”™è¯¯çš„æ“ä½œç»™äº†æˆ‘ä»¬ä¸€ä¸ªæ€è·¯ï¼šä¸ºä»€ä¹ˆ hooks è¦å¦‚æ­¤è§„å®šã€‚</p><blockquote><p>The React team are stipulating the usage rules because not following them will lead to inconsistent data</p></blockquote><h4 id="æƒ³æƒ³-hooks-æ“ä½œä¸€ç³»åˆ—çš„æ•°ç»„ï¼Œé‚£ä¹ˆä½ å°±ä¸ä¼šæ‰“ç ´è§„åˆ™äº†ï¼ˆThink-about-hooks-manipulating-a-set-of-arrays-and-you-wont-break-the-rulesï¼‰"><a href="#æƒ³æƒ³-hooks-æ“ä½œä¸€ç³»åˆ—çš„æ•°ç»„ï¼Œé‚£ä¹ˆä½ å°±ä¸ä¼šæ‰“ç ´è§„åˆ™äº†ï¼ˆThink-about-hooks-manipulating-a-set-of-arrays-and-you-wont-break-the-rulesï¼‰" class="headerlink" title="æƒ³æƒ³ hooks æ“ä½œä¸€ç³»åˆ—çš„æ•°ç»„ï¼Œé‚£ä¹ˆä½ å°±ä¸ä¼šæ‰“ç ´è§„åˆ™äº†ï¼ˆThink about hooks manipulating a set of arrays and you wont break the rulesï¼‰"></a>æƒ³æƒ³ hooks æ“ä½œä¸€ç³»åˆ—çš„æ•°ç»„ï¼Œé‚£ä¹ˆä½ å°±ä¸ä¼šæ‰“ç ´è§„åˆ™äº†ï¼ˆThink about hooks manipulating a set of arrays and you wont break the rulesï¼‰</h4><p>ç°åœ¨åº”è¯¥èƒ½å¾ˆæ¸…æ™°ç†è§£ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶æˆ–è€…å¾ªç¯è¯­å¥ä¸­ä½¿ç”¨ <code>use</code> hook äº†ï¼šå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†æŒ‡é’ˆæŒ‡å‘äº†æ•°ç»„ï¼Œå¦‚æœåœ¨ render çš„æ—¶å€™æ”¹å˜äº†é¡ºåºï¼Œé‚£ä¹ˆæŒ‡é’ˆå°±ä¸èƒ½å¯¹åº”æ­£ç¡®çš„æ•°æ®ï¼Œæ‰€ä»¥è°ƒç”¨ use ä¹Ÿä¸ä¼šæŒ‡å‘æ­£ç¡®çš„æ•°æ®å’Œ setterã€‚</p><p>å› æ­¤ï¼Œè¯€çªå°±æ˜¯å°† hooks æƒ³åƒæˆç”¨æ’å®šçš„æŒ‡é’ˆæ¥ç®¡ç†ä¸€ç³»åˆ—æ•°ç»„ã€‚å¦‚æœèƒ½åšåˆ°è¿™ä¸ªï¼Œé‚£ä¹ˆä¸€åˆ‡å°±èƒ½æŒ‰é¢„æœŸè¿›è¡Œã€‚</p><h4 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h4><p>å¸Œæœ›æˆ‘å·²ç»å°±å¦‚ä½•æ€è€ƒ hooks api çš„å·¥ä½œåŸç†æŒ‡å‡ºäº†ä¸€ä¸ªæ¸…æ™°çš„å¿ƒæ™ºæ¨¡å‹ã€‚ï¼ˆåé¢å°±å·ä¸ªæ‡’ä¸ç¿»è¯‘äº†ï¼ŒåŸºæœ¬æ˜¯ä¸Šè¿°è§‚ç‚¹çš„é‡å¤å¼ºè°ƒã€‚ï¼‰</p><p>Hopefully I have laid out a clearer mental model for how to think about what is going on under the hood with the new hooks API. Remember the true value here is being able to group concerns together so being careful about order and using the hooks API will have a high payoff.</p><p>Hooks is an effective plugin API for React Components. There is a reason why people are excited about this and if you think about this kind of model where state exists as a set of arrays then you should not find yourselves breaking the rules around their usage.</p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å…¥å‘flutter</title>
      <link href="/2020/07/24/%E5%89%8D%E7%AB%AF%E5%85%A5%E5%9D%91flutter/"/>
      <url>/2020/07/24/%E5%89%8D%E7%AB%AF%E5%85%A5%E5%9D%91flutter/</url>
      
        <content type="html"><![CDATA[<h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>è¸©è¿‡ RN çš„å‘ä¹‹åè¶Šå‘æƒ³å°è¯•å­¦ä¹ ä¸‹ flutter çš„å¼€å‘ï¼Œæœ¬æ–‡ç”¨äºè®°å½•ä¸‹å¼€å‘è¿‡ç¨‹ä¸­çš„é—®é¢˜ä¸æ€è€ƒï¼Œæœ¬æ¥æ˜¯å†™åœ¨ notion é‡Œçš„ï¼Œæœ€è¿‘ notion æ— æ³•æ‰“å¼€ï¼Œæ•…è®°å½•äºæ­¤ã€‚</p><a id="more"></a><h4 id="Flutterä¸ºä»€ä¹ˆé€‰æ‹©äº†-Dartè€Œä¸æ˜¯-JavaScript"><a href="#Flutterä¸ºä»€ä¹ˆé€‰æ‹©äº†-Dartè€Œä¸æ˜¯-JavaScript" class="headerlink" title="Flutterä¸ºä»€ä¹ˆé€‰æ‹©äº† Dartè€Œä¸æ˜¯ JavaScript"></a>Flutterä¸ºä»€ä¹ˆé€‰æ‹©äº† Dartè€Œä¸æ˜¯ JavaScript</h4><p>é¦–å…ˆè¦äº†è§£ä¸¤ä¸ªæ¦‚å¿µï¼šJITå’ŒAOTã€‚<br>ç›®å‰ï¼Œç¨‹åºä¸»è¦æœ‰ä¸¤ç§è¿è¡Œæ–¹å¼ï¼šé™æ€ç¼–è¯‘ä¸åŠ¨æ€è§£é‡Šã€‚é™æ€ç¼–è¯‘çš„ç¨‹åºåœ¨æ‰§è¡Œå‰å…¨éƒ¨è¢«ç¿»è¯‘ä¸ºæœºå™¨ç ï¼Œé€šå¸¸å°†è¿™ç§ç±»å‹ç§°ä¸º<strong>AOT</strong> ï¼ˆAhead of timeï¼‰å³ â€œæå‰ç¼–è¯‘â€ï¼›è€Œè§£é‡Šæ‰§è¡Œçš„åˆ™æ˜¯ä¸€å¥ä¸€å¥è¾¹ç¿»è¯‘è¾¹è¿è¡Œï¼Œé€šå¸¸å°†è¿™ç§ç±»å‹ç§°ä¸º<strong>JIT</strong>ï¼ˆJust-in-timeï¼‰å³â€œå³æ—¶ç¼–è¯‘â€ã€‚AOTç¨‹åºçš„å…¸å‹ä»£è¡¨æ˜¯ç”¨C/C++å¼€å‘çš„åº”ç”¨ï¼Œå®ƒä»¬å¿…é¡»åœ¨æ‰§è¡Œå‰ç¼–è¯‘æˆæœºå™¨ç ï¼Œè€ŒJITçš„ä»£è¡¨åˆ™éå¸¸å¤šï¼Œå¦‚JavaScriptã€pythonç­‰ï¼Œäº‹å®ä¸Šï¼Œæ‰€æœ‰è„šæœ¬è¯­è¨€éƒ½æ”¯æŒJITæ¨¡å¼ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯JITå’ŒAOTæŒ‡çš„æ˜¯ç¨‹åºè¿è¡Œæ–¹å¼ï¼Œå’Œç¼–ç¨‹è¯­è¨€å¹¶éå¼ºå…³è”çš„ï¼Œæœ‰äº›è¯­è¨€æ—¢å¯ä»¥ä»¥JITæ–¹å¼è¿è¡Œä¹Ÿå¯ä»¥ä»¥AOTæ–¹å¼è¿è¡Œï¼Œå¦‚Javaã€Pythonï¼Œå®ƒä»¬å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ç¼–è¯‘æˆä¸­é—´å­—èŠ‚ç ã€ç„¶ååœ¨ä¹‹åæ‰§è¡Œæ—¶å¯ä»¥ç›´æ¥æ‰§è¡Œå­—èŠ‚ç ï¼Œä¹Ÿè®¸æœ‰äººä¼šè¯´ï¼Œä¸­é—´å­—èŠ‚ç å¹¶éæœºå™¨ç ï¼Œåœ¨ç¨‹åºæ‰§è¡Œæ—¶ä»ç„¶éœ€è¦åŠ¨æ€å°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç ï¼Œæ˜¯çš„ï¼Œè¿™æ²¡æœ‰é”™ï¼Œä¸è¿‡é€šå¸¸æˆ‘ä»¬åŒºåˆ†æ˜¯å¦ä¸ºAOTçš„æ ‡å‡†å°±æ˜¯çœ‹ä»£ç åœ¨æ‰§è¡Œä¹‹å‰æ˜¯å¦éœ€è¦ç¼–è¯‘ï¼Œåªè¦éœ€è¦ç¼–è¯‘ï¼Œæ— è®ºå…¶ç¼–è¯‘äº§ç‰©æ˜¯å­—èŠ‚ç è¿˜æ˜¯æœºå™¨ç ï¼Œéƒ½å±äºAOTã€‚åœ¨æ­¤ï¼Œè¯»è€…ä¸å¿…çº ç»“äºæ¦‚å¿µï¼Œæ¦‚å¿µå°±æ˜¯ä¸ºäº†ä¼ è¾¾ç²¾ç¥è€Œå‘æ˜çš„ï¼Œåªè¦è¯»è€…èƒ½å¤Ÿç†è§£å…¶åŸç†å³å¯ï¼Œå¾—å…¶ç¥å¿˜å…¶å½¢ã€‚<br>JavaScriptä¸ºè„šæœ¬è¯­è¨€ï¼Œæ‰§è¡Œæ—¶éœ€è¦JIT(Just In Time)ï¼Œæ‰§è¡Œæ•ˆç‡å’ŒAOT(Ahead Of Time)ä»£ç ä»æœ‰å·®è·ã€‚<br>Dartåœ¨ JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰æ¨¡å¼ä¸‹ï¼Œé€Ÿåº¦ä¸ JavaScriptåŸºæœ¬æŒå¹³ã€‚<br>ä½†æ˜¯ Dartæ”¯æŒ AOTï¼Œå½“ä»¥ AOTæ¨¡å¼è¿è¡Œæ—¶ï¼ŒJavaScriptä¾¿è¿œè¿œè¿½ä¸ä¸Šäº†ã€‚</p><h4 id="ç½‘é¡µå¼€å‘"><a href="#ç½‘é¡µå¼€å‘" class="headerlink" title="ç½‘é¡µå¼€å‘"></a>ç½‘é¡µå¼€å‘</h4><p>ç°åœ¨ flutter å·²ç»æ”¯æŒ web äº†ï¼Œåˆ‡æ¢åˆ° beta ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">// å¯åŠ¨å¼€å‘æ¨¡å¼<br>flutter run -d chrome<br></code></pre></td></tr></table></figure><h4 id="é…ç½®ç¯å¢ƒ"><a href="#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h4><p>è¿‡ç¨‹ä¸æï¼Œæ–‡æ¡£è®²çš„æ¯”è¾ƒæ¸…æ™°äº†ï¼Œæ³¨æ„é…ç½®å›½å†…çš„æºå³å¯ã€‚</p><h4 id="é¡¹ç›®ç»“æ„ä¸å‘½åè§„èŒƒ"><a href="#é¡¹ç›®ç»“æ„ä¸å‘½åè§„èŒƒ" class="headerlink" title="é¡¹ç›®ç»“æ„ä¸å‘½åè§„èŒƒ"></a>é¡¹ç›®ç»“æ„ä¸å‘½åè§„èŒƒ</h4><p>dart çš„æ–‡ä»¶åæ˜¯ç”¨ä¸‹åˆ’çº¿è¿æ¥çš„ï¼Œæºæ–‡ä»¶åœ¨ lib ç›®å½•ä¸‹ï¼Œmain.dart ä¸ºå…¥å£æ–‡ä»¶, ä» main å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œä¸‹åˆ’çº¿å¼€å¤´çš„å˜é‡ä¸ºç§æœ‰å˜é‡</p><h4 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h4><p>dart é‡Œå¦‚ä½•å¯¼å…¥æœ¬åœ°æ–‡ä»¶çš„å‘¢ï¼Ÿå’Œå¼•ç”¨ç¬¬ä¸‰æ–¹çš„åº“çš„ç”¨æ³•ä¸€æ ·ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:&#123;é¡¹ç›®å&#125;/&#123;æ–‡ä»¶å&#125;'</span>;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­æˆå‘˜å˜é‡è‡ªåŠ¨å¯¼å‡ºï¼Œé‚£ä¹ˆå¦‚ä½•é˜²æ­¢å‘½åå†²çªï¼Ÿ:</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:&#123;é¡¹ç›®å&#125;/&#123;æ–‡ä»¶å&#125;'</span> <span class="hljs-keyword">as</span> MyModule;<br></code></pre></td></tr></table></figure><p>é€šè¿‡ as æ¥æŒ‡å®šåŒ…åï¼Œæ­¤æ—¶è¦ä½¿ç”¨å†…éƒ¨æˆå‘˜å°±éœ€è¦ MyModule.xxxã€‚</p><p>ä¹Ÿå¯ä»¥å±è”½æŸäº›å˜é‡å¯¼å‡ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:&#123;é¡¹ç›®å&#125;/&#123;æ–‡ä»¶å&#125;'</span> <span class="hljs-keyword">hide</span> MyVar;<br></code></pre></td></tr></table></figure><h4 id="ğŸ’€-Divider-åœ¨-web-éœ€è¦ä¼ -thickness"><a href="#ğŸ’€-Divider-åœ¨-web-éœ€è¦ä¼ -thickness" class="headerlink" title="ğŸ’€ Divider åœ¨ web éœ€è¦ä¼  thickness"></a>ğŸ’€ Divider åœ¨ web éœ€è¦ä¼  thickness</h4><p>å¦åˆ™ä¸æ¸²æŸ“ï¼Œ issue å¦‚ä¸‹ï¼š <a href="https://github.com/flutter/flutter/issues/46339" target="_blank" rel="noopener">https://github.com/flutter/flutter/issues/46339</a></p><h4 id="ğŸ’€-BottomNavigationBar"><a href="#ğŸ’€-BottomNavigationBar" class="headerlink" title="ğŸ’€ BottomNavigationBar"></a>ğŸ’€ BottomNavigationBar</h4><p>å¦‚æœè¶…è¿‡ 3 ä¸ª itemsï¼ŒèƒŒæ™¯ä¼šå˜ç™½ï¼ŒåŸå› æ˜¯è¶…è¿‡ 3 ä¸ª BottomNavigationBar çš„ type ä¼šå˜æˆ BottomNavigationBarType.shifting ç±»å‹ï¼Œè¯¦æƒ…è§ <a href="https://github.com/flutter/flutter/issues/13642#issuecomment-371875044ï¼Œè§£å†³çš„åŠæ³•æ˜¯è®¾ç½®" target="_blank" rel="noopener">https://github.com/flutter/flutter/issues/13642#issuecomment-371875044ï¼Œè§£å†³çš„åŠæ³•æ˜¯è®¾ç½®</a> type å±æ€§ä¸º fixedã€‚</p><h4 id="è¿›ç¨‹é”æ­»"><a href="#è¿›ç¨‹é”æ­»" class="headerlink" title="è¿›ç¨‹é”æ­»"></a>è¿›ç¨‹é”æ­»</h4><p>é‡åˆ°æ§åˆ¶å°æç¤ºï¼ŒWaiting for another flutter command to release the startup lockâ€¦ å¯ä»¥ç®€å•ç²—æš´æ€è¿›ç¨‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">killall -9 dart<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å¸¸è§çš„å®‰å…¨é—®é¢˜æ±‡æ€»</title>
      <link href="/2020/07/23/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"/>
      <url>/2020/07/23/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>æœ€è¿‘å®‰å…¨éƒ¨é—¨çš„å°ä¼™ä¼´æäº†ä¸€ä¸ªå‰ç«¯å®‰å…¨çš„æ¼æ´ï¼Œæƒ³åˆ°å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­æœ‰æ—¶å€™å¾€å¾€è¿½æ±‚å¼€å‘æ•ˆç‡ï¼Œå¿½ç•¥æ‰ä¸€äº›å®‰å…¨é—®é¢˜ï¼Œä»¥ä¸‹ç®€å•æ€»ç»“ä¸€äº›è‡ªå·±é‡åˆ°è¿‡çš„ä»¥åŠä¸€äº›å¸¸è§çš„æ”»å‡»æ‰‹æ®µï¼Œä»¥è‡ªæŸ¥è‡ªçœã€‚</p><a id="more"></a><h4 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h4><p>å›åˆ°å®‰å…¨éƒ¨é—¨æå‡ºçš„æ¼æ´ï¼Œåœºæ™¯è¿˜åŸå¦‚ä¸‹ï¼š<br>è¿™æ˜¯ä¸€ä¸ªè€é¡¹ç›®ï¼Œå±•ç¤ºæ–‡ç« ç”¨ï¼Œé¡µé¢è·¯ç”±ä¸º <a href="http://xxx/article/:id?these-are-queriesï¼Œnode" target="_blank" rel="noopener">http://xxx/article/:id?these-are-queriesï¼Œnode</a> å±‚æ”¶åˆ°è¿™ä¸ª url åï¼Œè¿”å›è¿”å›è¯¥æ–‡ç«  htmlï¼Œå†…å®¹åˆ™åŒ…æ‹¬äº†ã€æ¨èæ–‡ç« ã€‘ï¼Œ è€Œæ¨èæ–‡ç« çš„é“¾æ¥åˆ™æ˜¯æ ¹æ® url çš„å€¼æ¥çš„ï¼Œä»…å˜åŒ– idã€‚æ­¤æ—¶å¦‚æœåœ¨ url ä¸Šçš„ query ä¸Šæ„é€ ä¸€æ®µæ¶æ„è„šæœ¬ï¼Œç„¶åå¼•å¯¼ç”¨æˆ·æ‰“å¼€ï¼Œé‚£ä¹ˆç”¨æˆ·æ‰“å¼€é¡µé¢åå°±ä¼šè¿è¡Œè¯¥æ¶æ„è„šæœ¬ã€‚<br>ä¸Šè¿°æ­£æ˜¯ä¸€ä¸ªå…¸å‹çš„ XSS æ”»å‡»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p>XSSæ˜¯è·¨ç«™è„šæœ¬æ”»å‡»(Cross Site Scripting)ï¼Œä¸ºä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets, CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSã€‚æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚</p></blockquote><p>XSS çš„æœ¬è´¨æ˜¯ä¿¡ä»»äº†æŸäº›ä¸å®‰å…¨çš„è¾“å…¥ï¼Œå¯¼è‡´æ¶æ„ä»£ç æ··å…¥æ­£å¸¸ä»£ç ï¼Œè¿›è€Œå‘ç”Ÿçš„æ”»å‡»è¡Œä¸ºã€‚å¸¸è§çš„ä¸å®‰å…¨è¾“å…¥æœ‰ï¼š</p><ol><li>ä¸Šé¢æåˆ°çš„ url å‚æ•°ï¼Œè¿™ç§éœ€è¦è¯±å¯¼ç”¨æˆ·å–ç‚¹å‡»</li><li>ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œæ¯”å¦‚ç”¨æˆ·å‘è¡¨è¯„è®º</li><li>ç¬¬ä¸‰æ–¹çš„é“¾æ¥ç­‰</li></ol><p>é˜²èŒƒçš„æ–¹æ³•é€šå¸¸æ˜¯ï¼šå¯¹ç”¨æˆ·è¾“å…¥å†…å®¹å’ŒæœåŠ¡ç«¯è¿”å›å†…å®¹è¿›è¡Œè¿‡æ»¤å’Œè½¬è¯‘ã€‚</p><h4 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h4><p>CSRF æ”»å‡»å¸¸è§çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>ç”¨æˆ·ç™»å½•ä½ çš„ç½‘ç«™ï¼Œäº§ç”Ÿç™»å½•å‡­è¯ï¼Œå¦‚ cookie</li><li>ç”¨æˆ·è¢«<strong>è¯±å¯¼</strong>ç™»å½•åˆ°æ¶æ„ç½‘ç«™</li><li>æ¶æ„ç½‘ç«™æºå¸¦åˆšåˆšåœ¨æµè§ˆå™¨äº§ç”Ÿçš„å‡­è¯å‘ä½ çš„æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¶æ„è¯·æ±‚</li><li>ä½ çš„æœåŠ¡å™¨æ— æ³•è¯†åˆ«æ˜¯å¦æ¶æ„è¯·æ±‚ï¼Œè¯·æ±‚å®Œæˆï¼Œç”¨æˆ·å—å®³ã€‚</li></ol><p>ä¸ä¸Šé¢æåˆ°çš„ XSS æ”»å‡»æœ‰ä¸ªæ˜æ˜¾çš„åŒºåˆ«åœ¨äºï¼šCSRF æ”»å‡»å‘ç”Ÿåœ¨æ¶æ„ç½‘ç«™ï¼Œè€Œä¸æ˜¯è¢«æ”»å‡»çš„ç½‘ç«™ã€‚è€Œè¿™ä¹Ÿä½¿å¾—æ”»å‡»è€…å¹¶ä¸èƒ½è·å–åˆ°å—å®³è€…çš„ç™»å½•å‡­è¯ï¼Œä»…ä»…åªèƒ½ä½¿ç”¨ã€‚<br>é˜²èŒƒçš„æ–¹æ³•é€šå¸¸æ˜¯ï¼š</p><ol><li>è¯·æ±‚ url æ·»åŠ  token æˆ–è€…æ˜¯åœ¨ http è¯·æ±‚å¤´è‡ªå®šä¹‰å±æ€§è¿›è¡ŒéªŒè¯</li><li>åŒæºæ£€æµ‹ï¼Œé€šè¿‡è§£æ è¯·æ±‚å¤´ä¸­çš„ referer åˆ¤æ–­è¯·æ±‚æ¥æº</li><li>Samesiteï¼ŒGoogle èµ·è‰äº†ä¸€ä»½è‰æ¡ˆæ¥æ”¹è¿› HTTP åè®®ï¼Œä¸º Set-Cookie å“åº”å¤´æ–°å¢ Samesite å±æ€§ï¼Œç”¨äºæ ‡æ˜ Cookie æ˜¯å¦èƒ½ä½œç”¨äºå…¶ä»–ç½‘ç«™ï¼Œç›®å‰å…¼å®¹æ€§è¿˜ä¸æ˜¯å¾ˆå¥½ã€‚</li></ol><h4 id="Iframe"><a href="#Iframe" class="headerlink" title="Iframe"></a>Iframe</h4><p>å½“æˆ‘ä»¬ä½¿ç”¨ iframe åŠ è½½ç¬¬ä¸‰æ–¹ç½‘ç«™æ—¶ï¼Œç¬¬ä¸‰æ–¹ç½‘ç«™å¯ä»¥å¯¹æˆ‘ä»¬çš„ç½‘ç«™æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå¦‚æ“ä½œDOMï¼ŒåŠ è½½ js ç­‰ã€‚<br>é˜²èŒƒçš„æ–¹æ³•æ˜¯é€šè¿‡è®¾ç½® sandbox å±æ€§æ§åˆ¶ iframe çš„æ“ä½œæƒé™ã€‚</p><h4 id="opener"><a href="#opener" class="headerlink" title="opener"></a>opener</h4><p>æˆ‘ä»¬åœ¨é€šå¸¸é€šè¿‡ä»¥ä¸‹å†™æ³•åœ¨ æ–° tab ä¸‹æ‰“å¼€é“¾æ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-number">1.</span> &lt;a target=<span class="hljs-string">'_blank'</span> href=<span class="hljs-string">'new-site.com'</span>&gt;<br><span class="hljs-number">2.</span> <span class="hljs-built_in">window</span>.open(<span class="hljs-string">'new-site.com'</span>)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä¸¤ç§å†™æ³•çš„é—®é¢˜åœ¨äºï¼Œ <code>new-site.com</code> æ˜¯å¯ä»¥é€šè¿‡ <code>window.opener</code> æ¥æ‹¿åˆ°æºé¡µé¢çš„ <code>window</code> å¯¹è±¡ï¼Œè¿›è€Œè¿›è¡Œæ¶æ„æ“ä½œã€‚<br>é˜²èŒƒçš„æ–¹æ³•é€šå¸¸æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-number">1.</span> &lt;a target=<span class="hljs-string">"_blank"</span> href=<span class="hljs-string">"new-site.com"</span> rel=<span class="hljs-string">"noopener noreferrer nofollow"</span>&gt;aæ ‡ç­¾è·³è½¬url&lt;<span class="hljs-regexp">/a&gt;</span><br><span class="hljs-regexp">2. function openurl(url) &#123;</span><br><span class="hljs-regexp">    var newTab = window.open();</span><br><span class="hljs-regexp">    newTab.opener = null;</span><br><span class="hljs-regexp">    newTab.location = url;</span><br><span class="hljs-regexp">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><ul><li><p><a href="https://tech.meituan.com/2018/09/27/fe-security.html" target="_blank" rel="noopener">å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šå¦‚ä½•é˜²æ­¢XSSæ”»å‡»ï¼Ÿ</a></p></li><li><p><a href="https://tech.meituan.com/2018/10/11/fe-security-csrf.html" target="_blank" rel="noopener">å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•é˜²æ­¢CSRFæ”»å‡»ï¼Ÿ</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN é¿å‘æŒ‡åŒ—</title>
      <link href="/2020/07/21/RN%20%E9%81%BF%E5%9D%91%E6%8C%87%E5%8C%97/"/>
      <url>/2020/07/21/RN%20%E9%81%BF%E5%9D%91%E6%8C%87%E5%8C%97/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•å¹³æ—¶å¼€å‘ rn æ—¶é‡åˆ°çš„é—®é¢˜ï¼Œç‰¹æŒ‡ 0.59 ç‰ˆæœ¬ï¼Œä¸åŒç‰ˆæœ¬å¯èƒ½æƒ…å†µä¸åŒï¼Œä»…ä¾›å‚è€ƒã€‚</p><a id="more"></a><h5 id="ä¸€åƒç´ é—®é¢˜"><a href="#ä¸€åƒç´ é—®é¢˜" class="headerlink" title="ä¸€åƒç´ é—®é¢˜"></a>ä¸€åƒç´ é—®é¢˜</h5><p>rn è§£å†³ä¸€åƒç´ å¾ˆç®€å•ï¼Œåªéœ€è¦  <code>StyleSheet.hairlineWidth</code> å³å¯è§£å†³ã€‚</p><h5 id="TextInput-ç»„ä»¶"><a href="#TextInput-ç»„ä»¶" class="headerlink" title="TextInput  ç»„ä»¶"></a>TextInput  ç»„ä»¶</h5><p>è‡ªå¸¦å†…è¾¹è·ï¼Œå¤šè¡Œæ–‡å­—æ—¶æ–‡å­—å±…ä¸­å±•ç¤ºï¼Œæƒ³è¦æ¶ˆé™¤éœ€è¦è®¾ç½®æ ·å¼å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">// æ–‡å­—å‘ä¸Šå¯¹é½<br>textAlignVertical: 'top'<br>// æ¶ˆé™¤å†…è¾¹è·<br><span class="hljs-selector-tag">padding</span>: 0<br></code></pre></td></tr></table></figure><p>Placeholder åœ¨ ios å’Œ android ä¸‹é»˜è®¤é¢œè‰²è¡¨ç°ä¸ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡ <code>placeholderTextColor</code>  å±æ€§è¿›è¡Œè®¾ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">placeholderTextColor=<span class="hljs-string">"#CCCCCC"</span><br></code></pre></td></tr></table></figure><h5 id="é˜´å½±"><a href="#é˜´å½±" class="headerlink" title="é˜´å½±"></a>é˜´å½±</h5><p>å› ä¸ºè®¾è®¡ç†å¿µçš„é—®é¢˜ï¼Œandroid ä¸‹å‡ ä¹æ— æ³•å®ç°å’Œ ios ä¸€è‡´çš„é˜´å½±æ•ˆæœã€‚è€Œ flutter åŸºäº skia å¼•æ“æ¸²æŸ“ï¼Œåº”è¯¥ä¼šæœ‰æ¯”è¾ƒå¥½çš„è¡¨ç°ï¼Ÿæœ‰ç©ºå°è¯•ä¸‹ã€‚ ğŸ¤”</p><h5 id="border-è™šçº¿"><a href="#border-è™šçº¿" class="headerlink" title="border è™šçº¿"></a>border è™šçº¿</h5><p>border è™šçº¿ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜, android ä¸Šå®æµ‹æ— æ•ˆï¼Œè¯¦æƒ…çœ‹ <a href="https://github.com/facebook/react-native/issues/17251" target="_blank" rel="noopener">issue</a>ã€‚è§£å†³æ–¹æ¡ˆæ˜¯å¾ªç¯ä¸€ä¸ª pattern ç„¶å overhidden æ‰ï¼Œåˆå¤šäº†ä¸€ä¸ªè®©æˆ‘æƒ³å°è¯• flutter çš„ç†ç”± ğŸ˜‚</p><h5 id="å¤šè¡Œæ–‡å­—"><a href="#å¤šè¡Œæ–‡å­—" class="headerlink" title="å¤šè¡Œæ–‡å­—"></a>å¤šè¡Œæ–‡å­—</h5><p>å¤šè¡Œæ–‡å­—åœ¨ android æœºå‹ä¸‹æœ‰å¯èƒ½ä¼šå‡ºç°é«˜åº¦ä¸å¤Ÿå¯¼è‡´æ–‡å­—è¢«æˆªæ‰çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•ï¼šè®¾ç½®  <code>lineHeight</code></p><h5 id="å®ç°ä¸åŒå­—å·çš„æ–‡å­—åº•éƒ¨å¯¹é½"><a href="#å®ç°ä¸åŒå­—å·çš„æ–‡å­—åº•éƒ¨å¯¹é½" class="headerlink" title="å®ç°ä¸åŒå­—å·çš„æ–‡å­—åº•éƒ¨å¯¹é½"></a>å®ç°ä¸åŒå­—å·çš„æ–‡å­—åº•éƒ¨å¯¹é½</h5><p>ä¾‹å¦‚ Â¥500 æƒ³è¦ Â¥ å­—å·å°ä¸€ç‚¹ï¼Œè€Œ 500 å­—å·å¤§ä¸€ç‚¹ï¼Œä½†æ˜¯éœ€è¦åº•éƒ¨å¯¹é½ï¼Œåˆ™å¯ä»¥ç”¨ Text åŒ…è£¹èµ·æ¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs react">&lt;Text&gt;<br>  &lt;Text style&#x3D;&#123;&#123; fontSize: 12 &#125;&#125;&gt;Â¥&lt;&#x2F;Text&gt;<br>  &lt;Text style&#x3D;&#123;&#123; fontSize: 20 &#125;&#125;&gt;500&lt;&#x2F;Text&gt;<br>&lt;&#x2F;Text&gt;<br></code></pre></td></tr></table></figure><h5 id="Text-ç»„ä»¶æ ·å¼ç»§æ‰¿"><a href="#Text-ç»„ä»¶æ ·å¼ç»§æ‰¿" class="headerlink" title="Text ç»„ä»¶æ ·å¼ç»§æ‰¿"></a>Text ç»„ä»¶æ ·å¼ç»§æ‰¿</h5><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œcss å¦‚æœæƒ³è®¾ç½®é»˜è®¤çš„å…¨å±€æ ·å¼ç›¸å½“ç®€å•ï¼Œæ¯”å¦‚å­—ä½“é¢œè‰²é»˜è®¤ä¸º â€˜#323232â€™ , åªè¦åœ¨ body ä¸Šè®¾ç½®ä¸€ä¸‹ <code>color: #323232</code> å³å¯ ï¼Œç„¶è€Œå¯¹äº RN æ¥è¯´åˆ™æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p><ol><li><p>å°†åŸç”Ÿ Text æ›¿æ¢æˆè‡ªå®šä¹‰ Text ç»„ä»¶ï¼ˆå®˜æ–¹æ¨èï¼‰</p><blockquote><p>The recommended way to use consistent fonts and sizes across your application is to create a component <code>MyAppText</code> that includes them and use this component across your app</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs react">import React from &#39;react&#39;;<br>import &#123; TextProps, StyleSheet, Text &#125; from &#39;react-native&#39;;<br><br>const styles &#x3D; StyleSheet.create(&#123;<br>  defaultStyle: &#123;<br>    color: &#39;#323232&#39;,<br>  &#125;,<br>&#125;);<br><br>export default function CustomText(props: TextProps &amp; &#123; children?: any &#125;) &#123;<br>  const &#123; style, ...restProps &#125; &#x3D; props;<br>  return (<br>    &lt;Text style&#x3D;&#123;[styles.defaultStyle, style]&#125; &#123;...restProps&#125;&gt;<br>      &#123;props.children&#125;<br>    &lt;&#x2F;Text&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å‚è€ƒ <a href="https://github.com/Ajackster" target="_blank" rel="noopener">Ajackster</a>/<strong><a href="https://github.com/Ajackster/react-native-global-props" target="_blank" rel="noopener">react-native-global-props</a></strong> çš„å®ç°ï¼Œåœ¨é¡¹ç›®å…¥å£ä½ç½®ï¼Œä¿®æ”¹ç»„ä»¶çš„ render æ–¹æ³•ã€‚</p></li></ol><p>æ–¹æ¡ˆäºŒè™½ç„¶æ–¹ä¾¿ï¼Œä½†ä¸æ˜¯å®˜æ–¹è§£æ³•ï¼Œä¸‡ä¸€æœ‰å‘å°± GG äº†ã€‚è€Œæ–¹æ¡ˆä¸€å¦‚æœæ˜¯å·²æœ‰é¡¹ç›®ï¼Œåˆ™éœ€è¦æ‰¹é‡ä¿®æ”¹ä»£ç ã€‚<br>è¿™é‡Œé¡ºä¾¿æä¸€ä¸‹åœ¨ vscode é‡Œæ‰¹é‡æ›¿æ¢çš„æ–¹æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">// å°†æ­£åˆ™ï¼Œå¤§å°å†™ï¼Œå…¨åŒ¹é… ä¸‰ä¸ªæŒ‰é’®ç‚¹äº®<br>find: Text(,|\s)(.*react-nativ<span class="hljs-string">e';)</span><br><span class="hljs-string">replace: $2\nimport Text from '</span>Your/<span class="hljs-type">Text</span><span class="hljs-string">';</span><br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼Œåªè€ƒè™‘åˆ°äº†å•è¡Œï¼Œç»“æœä¸‹é¢è¿™ç§æƒ…å†µæ²¡æœ‰æ›¿æ¢æ‰ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">import &#123;<br><span class="hljs-built_in">  StyleSheet,</span><br><span class="hljs-built_in">  ViewStyle,</span><br><span class="hljs-built_in">  View,</span><br><span class="hljs-built_in">  Text,</span><br><span class="hljs-built_in">  Image,</span><br><span class="hljs-built_in">  TouchableOpacity,</span><br>&#125; from 'react-native'<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>åé¢æ¢æˆ <code>\sText[,|\s]\n?([\s\S]*&#39;react-native&#39;;)</code> åœ¨æµè§ˆå™¨é‡Œå¯ä»¥åŒ¹é…ä¸Šï¼Œä½†æ˜¯ vscode æ— æ³•åŒ¹é… ğŸ¤”ã€‚ æœ€åç®€å•å†™ä¸ªè„šæœ¬è¡¥å…¨ä¸Šé¢çš„æ¼ç½‘ä¹‹é±¼:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);<br><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);<br><span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);<br><br><span class="hljs-keyword">const</span> replace = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    glob(<span class="hljs-string">'src/**/*.tsx'</span>, &#123;&#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">er, files</span>) </span>&#123;<br>      <span class="hljs-keyword">const</span> reg = <span class="hljs-regexp">/\sText[,|\s]\n?([\s\S]*'react-native';)/</span>;<br>      files.forEach(<span class="hljs-keyword">async</span> (file) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> util.promisify(fs.readFile)(file, <span class="hljs-string">'utf8'</span>);<br>        <span class="hljs-keyword">const</span> newContent = content.replace(reg, (m, p1) =&gt; &#123;<br>          <span class="hljs-keyword">return</span> <span class="hljs-string">` <span class="hljs-subst">$&#123;p1.trim()&#125;</span></span><br><span class="hljs-string">import Text from '@/components/Text';`</span>;<br>        &#125;);<br>        <span class="hljs-keyword">await</span> util.promisify(fs.writeFile)(file, newContent, <span class="hljs-string">'utf8'</span>);<br>      &#125;);<br>    &#125;);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-built_in">console</span>.log(error);<br>  &#125;<br>&#125;;<br><br>replace();<br></code></pre></td></tr></table></figure><p>ğŸ¤” ä¸Šé¢ CustomText çš„å†™æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå³åµŒå¥— Text çš„æ ·å¼å¦‚æœæ˜¯è‡ªå®šä¹‰ç»„ä»¶ä¸­é»˜è®¤çš„æ ·å¼ï¼Œå°†ä¸ä¼šè¢«ç»§æ‰¿:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs react">&lt;Text style&#x3D;&#123;&#123; color: &#39;red&#39; &#125;&#125;&gt;<br>  &lt;Text&gt;red&lt;&#x2F;Text&gt;<br>  &lt;Text&gt;red&lt;&#x2F;Text&gt;<br>&lt;&#x2F;Text&gt;<br><br>&lt;CustomText style&#x3D;&#123;&#123; color: &#39;red&#39; &#125;&#125;&gt;<br>  &lt;CustomText&gt;not red&lt;&#x2F;Text&gt;<br>  &lt;CustomText&gt;not red&lt;&#x2F;Text&gt;<br>&lt;&#x2F;CustomText&gt;<br></code></pre></td></tr></table></figure><p>æ”¹è‰¯ç‰ˆï¼š </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs react">import React, &#123; Children, isValidElement, cloneElement &#125; from &#39;react&#39;;<br>import &#123; TextProps, StyleSheet, Text &#125; from &#39;react-native&#39;;<br><br>const styles &#x3D; StyleSheet.create(&#123;<br>  defaultStyle: &#123;<br>    color: &#39;#323232&#39;,<br>  &#125;,<br>&#125;);<br><br>export default function CustomText(<br>  props: TextProps &amp; &#123; children?: any; useDefaultStyle?: boolean &#125;,<br>) &#123;<br>  const &#123; style, useDefaultStyle &#x3D; true, ...restProps &#125; &#x3D; props;<br>  const newStyle &#x3D; useDefaultStyle ? [styles.defaultStyle, style] : style;<br><br>  const childrenWithProps &#x3D; Children.map(props.children, (child) &#x3D;&gt; &#123; <br>   if (isValidElement(child)) &#123;<br>     &#x2F;&#x2F; å¦‚æœå­å…ƒç´ æ˜¯ä¸ªç»„ä»¶ï¼Œåˆ™å­ç»„ä»¶ä¸ä½¿ç”¨é»˜è®¤ style<br>      return cloneElement(child as React.ReactElement&lt;any&gt;, &#123;<br>        useDefaultStyle: false,<br>      &#125;);<br>    &#125;<br>    return child;<br>  &#125;);<br><br>  return (<br>    &lt;Text style&#x3D;&#123;newStyle&#125; &#123;...restProps&#125;&gt;<br>      &#123;childrenWithProps&#125;<br>    &lt;&#x2F;Text&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p><a href="https://github.com/ptomasroos/react-native-scrollable-tab-view" target="_blank" rel="noopener">react-native-scrollable-tab-view</a></p><p><a href="https://github.com/ptomasroos/react-native-scrollable-tab-view" target="_blank" rel="noopener">react-native-scrollable-tab-view</a> ç»„ä»¶ä½œä¸º ScrollView çš„å­ç»„ä»¶æ—¶ä¸å¯ç”¨ï¼Œä¼šå‡ºç° tab é€‰ä¸­ä¸ä¸€è‡´ï¼Œtab content æ— æ³•æ’‘å¼€çš„ç°è±¡ï¼Œè¯¦æƒ…çœ‹ï¼š<a href="https://github.com/ptomasroos/react-native-scrollable-tab-view/issues/982" target="_blank" rel="noopener">https://github.com/ptomasroos/react-native-scrollable-tab-view/issues/982</a></p></li></ul><p>æœªå®Œå¾…ç»­ï½</p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡æ­å»º react é¡¹ç›®é‡åˆ°çš„å‘</title>
      <link href="/2020/07/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%90%AD%E5%BB%BA%20react%20%E9%A1%B9%E7%9B%AE%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/"/>
      <url>/2020/07/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E6%90%AD%E5%BB%BA%20react%20%E9%A1%B9%E7%9B%AE%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h5 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h5><p>ç”µå•†é¡¹ç›®éœ€è¦æ­å»ºä¸€ä¸ª h5 é¡¹ç›®ã€‚è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹æ­å»ºè¿‡ç¨‹é‡åˆ°çš„å‘ï¼Œä½œä¸ºæ€»ç»“ã€‚</p><a id="more"></a><p>ui æ¡†æ¶ï¼šä¸ºäº†ç»Ÿä¸€ ui æ¡†æ¶ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨ antd-mobileã€‚<br>æ‰“åŒ…ï¼šparceljs åœ¨æ­¤å‰çš„é¡¹ç›®ä¸­å·²ç»ä½¿ç”¨è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œæ‰“åŒ…é€Ÿåº¦è¾ƒ cra å¿«ï¼Œä¸”é…ç½®ç®€å•ï¼Œå› æ­¤æ‹Ÿç”¨ parcelã€‚<br>tsï¼šå¤šäººé¡¹ç›®è¿˜æ˜¯ä¸Š tsï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚<br>å¾ˆå¿«å°±æ­å»ºå¥½ demoï¼Œæ¥ç€å°±å¼€å§‹é‡åˆ°ä¸€äº›é—®é¢˜ã€‚</p><h5 id="antd-mobile-æŒ‰éœ€åŠ è½½"><a href="#antd-mobile-æŒ‰éœ€åŠ è½½" class="headerlink" title="antd-mobile æŒ‰éœ€åŠ è½½"></a>antd-mobile æŒ‰éœ€åŠ è½½</h5><p>antd-mobile æŒ‰éœ€åŠ è½½æ¨èä½¿ç”¨ <a href="https://github.com/ant-design/babel-plugin-import" target="_blank" rel="noopener">babel-plugin-import</a></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// .babelrc or babel-loader option</span><br>&#123;<br>  <span class="hljs-attr">"plugins"</span>: [<br>    [<span class="hljs-string">"import"</span>, &#123; <span class="hljs-attr">"libraryName"</span>: <span class="hljs-string">"antd-mobile"</span>, <span class="hljs-attr">"style"</span>: <span class="hljs-string">"css"</span> &#125;] <span class="hljs-comment">// `style: true` ä¼šåŠ è½½ less æ–‡ä»¶</span><br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­¤å‰ parcel å®é™…ä¸Šå†…ç½®æ”¯æŒäº† tsï¼Œç›´æ¥è½¬æˆ es5 äº†ï¼Œå› æ­¤æ­¤å‰æ²¡æœ‰é¢å¤–å†é…ç½® babelã€‚<br>ğŸ¤” babel-plugin-import åªæ”¯æŒ es6 module å†™æ³•çš„ä»£ç ï¼Œçœ‹æ¥éœ€è¦å…ˆæŠŠ ts è½¬æˆ es6 ç„¶ååœ¨é€šè¿‡ babel è½¬æˆ es5ï¼Œ æ²¡é—®é¢˜ï¼Œå®‰æ’ï½ äºæ˜¯ï¼š</p><ol><li><p>æ–°å¢ .babelrc</p></li><li><p>ä¿®æ”¹ tsconfig çš„ module ä¸º <code>es6</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"compilerOptions"</span>: &#123;<br>    <span class="hljs-attr">"module"</span>: <span class="hljs-string">"ES6"</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é¡¹ç›®å¯åŠ¨ï¼Œæ²¡é—®é¢˜ã€‚ä½†æ˜¯ vscode å¼€å§‹æŠ¥é”™ï¼š</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tsx">import React from &#39;react&#39;<br>&#x2F;&#x2F; Module &#39;&quot;&#x2F;node_modules&#x2F;@types&#x2F;react&#x2F;index&quot;&#39; can only be default-imported using the &#39;allowSyntheticDefaultImports&#39; flag<br></code></pre></td></tr></table></figure><p>æ ¹æœ¬åŸå› æ˜¯ç”±äº react å¯¼å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react.development.js'</span>)<br></code></pre></td></tr></table></figure><p>è€Œé</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">module</span>.exports.default = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react.development.js'</span>)<br></code></pre></td></tr></table></figure><p>Babel ä¼šåœ¨ commonjs æ ¼å¼æ·»åŠ  default å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®© ts ä¸è¦æç¤ºè¿™ç§ç±»å‹çš„æŠ¥é”™ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"compilerOptions"</span>: &#123;<br>    <span class="hljs-attr">"allowSyntheticDefaultImports"</span>: <span class="hljs-literal">true</span><br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ğŸ¤” ä¸è¿‡ä¸ºä»€ä¹ˆä¸€å¼€å§‹ parcel ä¸ä¼šæŠ¥é”™å‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥è·¯ç”±åŠ¨æ€å¼•å…¥ç»„ä»¶å¼€å§‹æŠ¥é”™ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tsx">import React, &#123; Suspense, lazy &#125; from &#39;react&#39;<br><br>const List &#x3D; lazy(() &#x3D;&gt; import(&#39;.&#x2F;modules&#x2F;List&#39;))<br>&#x2F;&#x2F; Dynamic imports are only supported when the &#39;--module&#39; flag is set to &#39;es2020&#39;, &#39;esnext&#39;, &#39;commonjs&#39;, &#39;amd&#39;, &#39;system&#39;, or &#39;umd&#39;.<br></code></pre></td></tr></table></figure><p>çœ‹æ¥ <code>es6</code> æ˜¯ä¸æ”¯æŒ import() è¯­æ³•, é‚£å¥½åŠï¼Œå°† module æ”¹æˆ <code>esnext</code>ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">"compilerOptions"</span>: &#123;<br>    <span class="hljs-attr">"module"</span>: <span class="hljs-string">"ESNext"</span>,<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¼•å…¥ anti-mobile ç»„ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; List &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'antd-mobile'</span><br><span class="hljs-comment">// Cannot find module 'antd-mobile' or its corresponding type declarations.</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æç¤ºæ‰¾ä¸åˆ°å¯¹åº”çš„æ¨¡å—å£°æ˜ï¼Œ æ­¤æ—¶æˆ‘çš„å†…å¿ƒæ˜¯å´©æºƒçš„ï¼Œçœ‹èµ·æ¥åº”è¯¥æ˜¯æ¨¡å—è§£æè·¯å¾„ä¸å¯¹ï¼Œå› æ­¤åœ¨ tsconfig ä¸­æ˜¾å¼é…ç½® <code>moduleResolution</code>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"compilerOptions"</span>: &#123;<br>    <span class="hljs-attr">"moduleResolution"</span>: <span class="hljs-string">"Node"</span><br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸å†æŠ¥é”™äº†ï¼Œçœ‹çœ‹ ts æ–‡æ¡£çš„è§£é‡Šå§ï¼Œts å…±æœ‰ä¸¤ç§å¯ç”¨çš„æ¨¡å—è§£æç­–ç•¥ï¼š<a href="https://www.tslang.cn/docs/handbook/module-resolution.html#node" target="_blank" rel="noopener">Node</a>å’Œ<a href="https://www.tslang.cn/docs/handbook/module-resolution.html#classic" target="_blank" rel="noopener">Classic</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">module</span> === <span class="hljs-string">"AMD"</span> or <span class="hljs-string">"System"</span> or <span class="hljs-string">"ES6"</span> ? <span class="hljs-string">"Classic"</span> : <span class="hljs-string">"Node"</span><br></code></pre></td></tr></table></figure><p>ğŸ¤” æŒ‰ç†è¯´ module ä¸º esnext çš„è¯å²‚ä¸æ˜¯åº”è¯¥æŒ‰ node ç­–ç•¥è§£æï¼Ÿä½†æ˜¯ç›®å‰çœ‹æ¥ä¼¼ä¹ä¸æ˜¯è¿™æ ·çš„ï¼Ÿ</p><h5 id="é…ç½®-antd-mobile-ä¸»é¢˜"><a href="#é…ç½®-antd-mobile-ä¸»é¢˜" class="headerlink" title="é…ç½® antd-mobile ä¸»é¢˜"></a>é…ç½® antd-mobile ä¸»é¢˜</h5><p>æ¥ä¸‹æ¥éœ€è¦é…ç½®ä¸»é¢˜ï¼Œanti-mobile æ¨èä½¿ç”¨ <a href="http://lesscss.org/usage/#using-less-in-the-browser-modify-variables" target="_blank" rel="noopener">modifyVars</a> æ¥é…ç½®ä¸»é¢˜ã€‚<br>å°† .babelrc æ”¹æˆåšä¸€ä¸‹è°ƒæ•´ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>    ...<br>    <span class="hljs-string">"plugins"</span>: [<br>        [<span class="hljs-string">"import"</span>, &#123;<span class="hljs-string">"libraryName"</span>: <span class="hljs-string">"antd-mobile"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-literal">true</span>&#125;],<br>        ...<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§ webpack çš„ç»éªŒï¼Œæ­¤æ—¶éœ€è¦å¼€å¯ <code>javascriptEnabled: true</code>é—®é¢˜æ¥äº† parcel å†…ç½®æ”¯æŒ less ï¼Œé‚£æˆ‘ä»¬è¦åœ¨å“ªé‡Œå»é…ç½® less å‘¢ï¼Ÿæ ¹æ® <a href="https://github.com/parcel-bundler/parcel/issues/907" target="_blank" rel="noopener">issue</a> æåˆ°å¯ä»¥ç”¨ .lessrc æ–‡ä»¶æ¥é…ç½®ï¼Œä½†æ˜¯æˆ‘ç»è¿‡å°è¯•å‘ç°å…¶å®æ˜¯æ— æ•ˆçš„ã€‚ã€‚<br>è‡³æ­¤åŸºæœ¬æ”¾å¼ƒ parcelã€‚parcel åœ¨å¿«é€Ÿæ­å»ºå®éªŒæ€§é¡¹ç›®æ—¶ç¡®å®æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä¸è¿‡ç”Ÿæ€ç¡®å®ä¸å¦‚ webpackï¼Œç”±æ­¤è½¬å‘ä½¿ç”¨ create-react-app</p><h5 id="create-react-app"><a href="#create-react-app" class="headerlink" title="create-react-app"></a>create-react-app</h5><p>ä½¿ç”¨ cra å¾ˆå¿«ä¹Ÿå»ºå¥½ demoï¼Œè§£å†³å¦‚ä½•è®© cra åˆ›å»ºçš„é¡¹ç›®æ”¯æŒ less ï¼Œè¿™ä¸ªç®€å•ï¼š<br>é€šè¿‡ <code>customize-cra</code> æä¾›çš„ <code>addLessLoader</code> æ–¹æ³•å³å¯ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº† <code>fixBabelImports</code> å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ·»åŠ  babel-plugin-import é…ç½®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; override, fixBabelImports, addLessLoader &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'customize-cra'</span>)<br><br><span class="hljs-built_in">module</span>.exports = override(<br>  fixBabelImports(<span class="hljs-string">'import'</span>, &#123;<br>    libraryName: <span class="hljs-string">'antd-mobile'</span>,<br>    style: <span class="hljs-literal">true</span>,<br>  &#125;),<br>  addLessLoader(&#123;<br>    lessOptions: &#123;<br>      javascriptEnabled: <span class="hljs-literal">true</span>,<br>      modifyVars: &#123;<br>        <span class="hljs-string">'@brand-primary'</span>: <span class="hljs-string">'#ff74b9'</span>,<br>        <span class="hljs-string">'brand-primary-tap'</span>: <span class="hljs-string">'#ff9cca'</span>,<br>      &#125;,<br>    &#125;,<br>  &#125;)<br>)<br></code></pre></td></tr></table></figure><h5 id="åˆ«å"><a href="#åˆ«å" class="headerlink" title="åˆ«å"></a>åˆ«å</h5><p>æ¥ç€æ˜¯é…ç½®è·¯å¾„åˆ«åé‡åˆ°çš„é—®é¢˜ï¼Œé€šè¿‡ <code>customize-cra</code> æä¾›çš„ <code>addWebpackAlias</code> å¯ä»¥é…ç½®åˆ«åï¼Œä½†æ˜¯ typescript ä¸€ç›´æ— æ³•è§£æå¯¹åº”åˆ«åï¼Œé‚£ä¹ˆåº”è¯¥åªéœ€è¦é…ç½®å¥½ ts çš„ paths å°±è¡Œäº†å§ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"compilerOptions"</span>: &#123;<br>    <span class="hljs-attr">"baseUrl"</span>: <span class="hljs-string">"."</span>,<br>    <span class="hljs-attr">"paths"</span>: &#123;<br>      <span class="hljs-attr">"@/*"</span>: [<span class="hljs-string">"./src/*"</span>]<br>    &#125;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>vscode ä¸å†æŠ¥é”™äº†,æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»äº†<code>npm run start</code>ï¼š<br>æ§åˆ¶å°æ˜¾ç¤º <code>- compilerOptions.paths must not be set (aliased imports are not supported)</code> å¹¶ä¸” cra ä¼šè‡ªåŠ¨æŠŠ tscongfig ä¸­çš„ paths ç§»é™¤æ‰ ğŸ˜‚<br>æ ¹æ® <a href="https://github.com/timarney/react-app-rewired/issues/375" target="_blank" rel="noopener">issue</a>ï¼Œä½¿ç”¨å°† baseUrl å’Œ paths çš„é…ç½®ç§»åŠ¨åˆ°å•ç‹¬çš„æ–‡ä»¶åï¼Œåœ¨ tsconfig é‡Œé€šè¿‡ extends çš„æ–¹å¼ç»§æ‰¿ï¼Œè™½ç„¶æ§åˆ¶å°ä¾ç„¶æç¤ºé”™è¯¯ï¼Œä½†æ˜¯åˆ«åå¯ä»¥ç”Ÿæ•ˆã€‚</p><h5 id="mini-css-extract-plugin"><a href="#mini-css-extract-plugin" class="headerlink" title="mini-css-extract-plugin"></a>mini-css-extract-plugin</h5><p>åœ¨ build æ—¶ï¼Œmini-css-extract-plugin æç¤º Conflicting orderï¼Œ é”™è¯¯ä½ç½®åœ¨ antd-mobile çš„æ ·å¼æ–‡ä»¶ã€‚æ ¹æ® <a href="https://github.com/ant-design/ant-design/issues/14895" target="_blank" rel="noopener">issue</a> ä»¥åŠ <a href="https://github.com/webpack-contrib/mini-css-extract-plugin/issues/250" target="_blank" rel="noopener"> issue </a>çœ‹æ¥è¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯ç”±äºæ‡’åŠ è½½åŠ ä¸Š antd ç»„ä»¶å¯¼å…¥é¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„ï¼Œç›®å‰çœ‹æ¥æ— éœ€è§£å†³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡å­¦ Generatorã€Šä¸€ã€‹</title>
      <link href="/2020/07/15/%E9%87%8D%E5%AD%A6%20Generator%E3%80%8A%E4%B8%80%E3%80%8B/"/>
      <url>/2020/07/15/%E9%87%8D%E5%AD%A6%20Generator%E3%80%8A%E4%B8%80%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<h5 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h5><p>åœ¨å®é™…å·¥ä½œçš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œä½¿ç”¨åˆ° Generator æ¯”è¾ƒå°‘ã€‚è¿‘æœŸæœ‰ä¸ªé¡¹ç›®çŠ¶æ€ç®¡ç†ä½¿ç”¨çš„æ˜¯ redux-sagaï¼Œè€Œ redux-saga åˆæ˜¯åŸºäº Generatorï¼Œå€Ÿæ­¤æœºä¼šé‡æ–°å­¦äº†ä¸‹ Generatorã€‚</p><p>æœ¬æ–‡ä¸»è¦æ˜¯è®°å½• generator çš„è¦ç‚¹ï¼Œä»¥é˜²å°†æ¥é—å¿˜ã€‚</p><a id="more"></a><h5 id="è°ƒç”¨-generator-å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨"><a href="#è°ƒç”¨-generator-å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨" class="headerlink" title="è°ƒç”¨ generator å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨"></a>è°ƒç”¨ generator å°†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</h5><p>æ‰€è°“ generator å®é™…ä¸Šå°±æ˜¯å¸¦æœ‰ * çš„å‡½æ•°ï¼Œè°ƒç”¨åä¸ä¼šæ‰§è¡Œ generator å†…éƒ¨ä»£ç ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª iterator</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'generator'</span>)<br>&#125;<br><span class="hljs-keyword">const</span> iterator = generatorFunction()<br><span class="hljs-built_in">console</span>.log(iterator[<span class="hljs-built_in">Symbol</span>.iterator])<br><br><span class="hljs-comment">// function [Symbol.iterator]()</span><br></code></pre></td></tr></table></figure><h5 id="æ‰§è¡Œ-generator"><a href="#æ‰§è¡Œ-generator" class="headerlink" title="æ‰§è¡Œ generator"></a>æ‰§è¡Œ generator</h5><p>æ¯æ¬¡è°ƒç”¨è¿”å›çš„è¿­ä»£å™¨çš„ next æ–¹æ³•å¯ä»¥æ‰§è¡Œ generator ä¸­çš„ä»£ç ï¼Œç›´åˆ°æ‰§è¡Œå®Œé‡åˆ°çš„ç¬¬ä¸€ä¸ª yield æˆ–è€… return åå¹¶äº¤å‡ºæ‰§è¡Œæƒ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'1'</span>)<br>  <span class="hljs-keyword">yield</span><br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'2'</span>)<br>  <span class="hljs-keyword">return</span><br>&#125;<br><span class="hljs-keyword">const</span> iterator = generatorFunction()<br>iterator.next()<br><span class="hljs-comment">// 1</span><br>iterator.next()<br><span class="hljs-comment">// 2</span><br></code></pre></td></tr></table></figure><h5 id="return-ä¸-yield-çš„å¼‚åŒ"><a href="#return-ä¸-yield-çš„å¼‚åŒ" class="headerlink" title="return ä¸ yield çš„å¼‚åŒ"></a>return ä¸ yield çš„å¼‚åŒ</h5><p>æ‰§è¡Œ iterator.next è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…æ‹¬ value å’Œ done ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ value å°±æ˜¯ <code>yield</code> æˆ– <code>return</code> åé¢è¡¨è¾¾å¼çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-keyword">const</span> iterator = generatorFunction()<br><span class="hljs-keyword">var</span> a = iterator.next()<br><span class="hljs-built_in">console</span>.log(a)<br><span class="hljs-comment">// &#123; value: 1, done: false &#125;</span><br><span class="hljs-keyword">var</span> b = iterator.next()<br><span class="hljs-built_in">console</span>.log(b)<br><span class="hljs-comment">// &#123; value: undefined, done: true &#125;</span><br></code></pre></td></tr></table></figure><p>yield ä¸ return ç±»ä¼¼ï¼Œä½† yield æ˜¯æš‚åœçš„æ„æ€ï¼Œè€Œ return åˆ™ä»£è¡¨ç»“æŸ, return ä¹‹åçš„ä»£ç å°†ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚</p><p>done ä¸º true è¡¨ç¤ºéå†ç»“æŸï¼Œä½†æ˜¯æ­¤æ—¶ä¾ç„¶å¯ä»¥å¯ä»¥ç»§ç»­è°ƒç”¨ iterator.next()ï¼Œåªä¸è¿‡è¿”å›å€¼å°†æ˜¯ { value: undefined, done: true }ã€‚</p><p><code>for...of</code>å¾ªç¯å¯ä»¥è‡ªåŠ¨éå† Generator å‡½æ•°è¿è¡Œæ—¶ç”Ÿæˆçš„<code>Iterator</code>å¯¹è±¡ï¼Œç›´åˆ° done å˜ä¸º trueã€‚</p><p>âš ï¸ done ä¸º true çš„è¿è¡Œç»“æœä¼šè¢«æŠ›å¼ƒæ‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">4</span>;<br>&#125;;<br><span class="hljs-keyword">const</span> iterator = generatorFunction();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index <span class="hljs-keyword">of</span> iterator) &#123;<br>    <span class="hljs-built_in">console</span>.log(index);<br>&#125;<br><span class="hljs-comment">// 1</span><br><span class="hljs-comment">// 2</span><br><span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure><h5 id="next-çš„å‚æ•°"><a href="#next-çš„å‚æ•°" class="headerlink" title="next çš„å‚æ•°"></a>next çš„å‚æ•°</h5><p>next çš„å‚æ•°å¯ä»¥æœ€ä¸º yield è¯­å¥çš„è¿”å›å€¼:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">yield</span><br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'a'</span>, a)<br>&#125;<br><span class="hljs-keyword">const</span> iterator = generatorFunction()<br>iterator.next()<br>iterator.next(<span class="hljs-number">1</span>)<br><span class="hljs-comment">// a 1</span><br></code></pre></td></tr></table></figure><h5 id="yield"><a href="#yield" class="headerlink" title="yield *"></a>yield *</h5><p>é€šè¿‡ yield * å¯ä»¥è¿›å…¥åˆ°å¦ä¸€ä¸ª generator ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> foo = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-string">'foo'</span>;<br>    <span class="hljs-keyword">yield</span> * bar();<br>&#125;;<br> <br><span class="hljs-keyword">const</span> bar = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-string">'bar'</span>;<br>    <span class="hljs-keyword">yield</span> * baz();<br>&#125;;<br> <br><span class="hljs-keyword">const</span> baz = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">yield</span> <span class="hljs-string">'baz'</span>;<br>&#125;;<br> <br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index <span class="hljs-keyword">of</span> foo()) &#123;<br>    <span class="hljs-built_in">console</span>.log(index);<br>&#125;<br><span class="hljs-comment">// foo</span><br><span class="hljs-comment">// bar</span><br><span class="hljs-comment">// baz</span><br></code></pre></td></tr></table></figure><h5 id="å‘-generaotr-å†…éƒ¨æŠ›å¼‚å¸¸"><a href="#å‘-generaotr-å†…éƒ¨æŠ›å¼‚å¸¸" class="headerlink" title="å‘ generaotr å†…éƒ¨æŠ›å¼‚å¸¸"></a>å‘ generaotr å†…éƒ¨æŠ›å¼‚å¸¸</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> generatorFunction = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">yield</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-keyword">if</span> (e != <span class="hljs-string">'a'</span>) &#123;<br>                <span class="hljs-keyword">throw</span> e;<br>            &#125;<br>            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Generator caught'</span>, e);<br>        &#125;<br>    &#125;<br>&#125;;<br><span class="hljs-keyword">const</span> iterator = generatorFunction();<br>iterator.next();<br><span class="hljs-keyword">try</span> &#123;<br>    iterator.throw(<span class="hljs-string">'a'</span>);<br>    iterator.throw(<span class="hljs-string">'b'</span>);<br>&#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Uncaught'</span>, e);<br>&#125;<br><span class="hljs-comment">// Generator caught a</span><br><span class="hljs-comment">// Uncaught b</span><br></code></pre></td></tr></table></figure><p>èµ„æ–™ä¸»è¦å‚è€ƒè‡ª  <a href="https://github.com/gajus/gajus.com-blog/blob/master/posts/the-definitive-guide-to-the-javascript-generators/index.md" target="_blank" rel="noopener">generator æƒå¨æŒ‡å—</a></p>]]></content>
      
      
      <categories>
          
          <category> webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
